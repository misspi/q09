<% content_for(:header) do %>
  <%=  javascript_include_tag 'ajaxupload.3.5.js' %>
<% end %>


<%= title t(:title) %>

<% form_for @survey do |form| %>
  <p>
    <%= form.label :name, t(:name) %>
    <%= form.text_field :name %>
  </p>

  <p>
    <%= form.label :page_url, t(:page_url) %>
    <%= form.text_field :page_url %>
  </p>

  <p>
    <%= form.label :icon, t(:icon) %>
    <%= form.text_field :icon, :id => 'upload_field' %>
	<%#= bucket('upload_field') %>
    <div id="upload_field_ajax">
      <div class="thumbnail"></div>
      <a id="upload_field_link" href="#"><%= t('upload') %></a>
      <img src="/images/spinner.gif" style="display: none" />
    </div>
    <script type="text/javascript">
      jQuery(function($) {
        $("#upload_field").hide();
        new AjaxUpload("#upload_field_link",
        {action: '<%= buckets_path(:format => 'js') %>',
          name: 'bucket[media]',
          data: {authenticity_token : '<%= form_authenticity_token %>', response: 'all'},
          onSubmit: function(file, extension) {
            $("#upload_field_ajax a").hide();
            $("#upload_field_ajax img").show();
          },
          onComplete: function(file, response) {
            $("#upload_field_ajax img").hide();
            $("#upload_field_ajax .thumbnail").html(response).show();
            response = response.replace('<pre>', '(');
            response = response.replace('</pre>', ')');
            var res = eval(response);
            $("#upload_field_ajax a").show();
            $("#upload_field_ajax .thumbnail").html('<img src="' + res['thumbnail'] + '" />');
          }
        });
      });
    </script>
  </p>


  <p>
    <%= form.label :location, t(:location) %>
    <%= form.text_field :location %>
  </p>


  <p>
    <%= form.label :indi_colective, t(:indi_colective) %>
    <%= form.radio_button :indi_colective, :individual %><label class="radio">Proyecto individual</label>
    <%= form.radio_button :indi_colective, :proyecto %><label class="radio">Proyecto colectivo</label>
    <%= form.radio_button :indi_colective, :ambos %><label class="radio">Ambos</label>
  </p>

  <p>
    <label>Actividad que desempe√±as</label>
    <table>
      <% Reu09.c(:presentacion, :ambito).each do |actividad| %>
        <tr>
          <td><%= t(actividad) %></td>
          <td><%= form.text_field actividad %></td>
        </tr>
      <% end %>
    </table>
  </p>

  <p>
    <%= form.label :interest, t(:interest) %>
    <%= form.text_area :interest %>
  </p>


  <p>
    <label>&nbsp;</label>
    <%= form.submit "Guardar" %>
  </p>
<% end %>
